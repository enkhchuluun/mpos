{"version":3,"sources":["../jsx/pos-counter.js"],"names":["PaymentModal","React","createClass","getInitialState","paymentType","cashReceived","props","total","cashReturn","componentDidMount","cashReceivedInput","focus","componentDidUpdate","console","log","changeToCash","setState","changeToCard","handleTextChange","parseInt","value","isNaN","handleKeyDown","event","keyCode","preventDefault","printReceipt","handleFocus","orderData","state","variantList","$","ajax","url","dataType","method","cache","data","JSON","stringify","processData","contentType","success","error_code","orderNo","iframe","on","window","frames","print","html","callBack","alert","message","error","bind","xhr","status","err","toString","modal","container","ReactDOM","unmountComponentAtNode","render","cashBtnClass","cardBtnClass","input","CounterItem","clickHandler","clickCallback","item","subPrice","numeral","price","selectedQuantity","format","className","isSelected","productName","CounterItemList","selectedIndex","quantityEditReset","componentWillReceiveProps","nextProps","itemList","length","addEventListener","handleCounterKey","componentWillUnmount","removeEventListener","rootDiv","handlePayBtn","targetIndex","removeItem","backspace","minusPlus","number","reset","counterKeyActionCallback","targetItem","index","findIndex","key","handleKeyPad","val","debug","forEach","i","productNo","variantNo","push","info","calculate","PaymentModalFactory","createFactory","_this","printCallback","handleCancelBtn","vat","itemCount","counterItemList","div","PosCounter","time","moment","timer","setInterval","clone","add","clearInterval","displayTime","branchName"],"mappings":"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","file":"pos-counter.js","sourcesContent":["var PaymentModal = React.createClass({\r\n    getInitialState: function () {\r\n        return {\r\n            paymentType: 'cash',\r\n            cashReceived: this.props.total,\r\n            cashReturn: 0\r\n        };\r\n    },\r\n    componentDidMount: function(){\r\n\r\n        /*setTimeout(function() {\r\n         console.log('focus on did mount!!!: %o', this.cashReceivedInput );\r\n         this.cashReceivedInput.focus();\r\n         }.bind(this), 400);*/\r\n\r\n        this.cashReceivedInput.focus();\r\n\r\n    },\r\n    componentDidUpdate: function(){\r\n        console.log('focus on did update');\r\n        this.cashReceivedInput.focus();\r\n    },\r\n    changeToCash: function() {\r\n        this.setState({\r\n            paymentType: 'cash'\r\n        });\r\n    },\r\n    changeToCard: function() {\r\n        this.setState({\r\n            paymentType: 'card'\r\n        });\r\n    },\r\n    handleTextChange: function() {\r\n        var cashReceived = parseInt(this.cashReceivedInput.value);\r\n        if (isNaN(cashReceived)) {\r\n            cashReceived = 0;\r\n        }\r\n        var cashReturn = this.props.total - cashReceived;\r\n\r\n        this.setState({\r\n            cashReceived: cashReceived,\r\n            cashReturn: cashReturn\r\n        });\r\n\r\n    },\r\n    handleKeyDown: function(event) {\r\n        if (event.keyCode == 13) {\r\n            event.preventDefault();\r\n\r\n            this.printReceipt();\r\n        }\r\n\r\n    },\r\n    handleFocus: function(){\r\n        console.log('has focus');\r\n    },\r\n    printReceipt: function() {\r\n        var orderData = {\r\n            cashReceived: this.state.cashReceived,\r\n            cashReturn: this.state.cashReturn,\r\n            variantList: this.props.variantList\r\n        };\r\n\r\n\r\n        $.ajax({\r\n            url: 'http://dev.merchant.jurur.mn/api/order/createPosOrder',\r\n            dataType: 'json',\r\n            method: 'POST',\r\n            cache: false,\r\n            data: JSON.stringify(orderData),\r\n            processData: false,\r\n            contentType: 'application/json',\r\n            success: function(data) {\r\n                if (data.error_code == 1000) {\r\n                    var url = '/pos/printReceipt?orderNo=' + data.orderNo;\r\n\r\n                    console.log('url:' + url);\r\n\r\n                    var iframe = $('<iframe src=\"' + url + '\" width=\"0\" height=\"0\" frameborder=\"0\" id=\"printReceiptIframe\" name=\"printReceiptIframe\" />');\r\n\r\n                    iframe.on('load', function(){\r\n                        window.frames['printReceiptIframe'].focus();\r\n                        window.frames['printReceiptIframe'].print();\r\n                    });\r\n\r\n                    $('#printIframeWrapper').html(iframe);\r\n\r\n                    this.props.callBack();\r\n                } else {\r\n                    alert(data.message);\r\n                    console.error('error:%O', data);\r\n                }\r\n\r\n            }.bind(this),\r\n            error: function(xhr, status, err) {\r\n                alert('серветэй холбогдоход алдаа гарлаа');\r\n                console.error(url, status, err.toString());\r\n\r\n            }.bind(this)\r\n        });\r\n\r\n        $('#paymentModal').modal('hide');\r\n\r\n        var container = $('#paymentModal .modal-body')[0];\r\n        ReactDOM.unmountComponentAtNode(container);\r\n    },\r\n    render: function(){\r\n        var cashBtnClass = 'btn btn-default btn-lg';\r\n        var cardBtnClass = 'btn btn-default btn-lg';\r\n\r\n        if (this.state.paymentType == 'cash') {\r\n            cashBtnClass = 'btn btn-success btn-lg';\r\n        }\r\n\r\n        if (this.state.paymentType == 'card') {\r\n            cardBtnClass = 'btn btn-success btn-lg';\r\n        }\r\n\r\n\r\n        return (\r\n            <div>\r\n                <div className=\"row\">\r\n                    <div className=\"form-group col-xs-6\">\r\n                        <label>Төлбөрийн төрөл</label>\r\n\r\n                        <div className=\"btn-group\">\r\n                            <button type=\"button\" className={cashBtnClass} onClick={this.changeToCash} ><i className=\"fa fa-money\"></i> Бэлэн</button>\r\n                            <button type=\"button\" className={cardBtnClass} onClick={this.changeToCard}><i className=\"fa fa-credit-card\"></i> Карт</button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"form-group col-xs-6\">\r\n                        <label>Төлөх дүн</label>\r\n                        <p className=\"form-control-static text-lg\" >{this.props.total}₮</p>\r\n                    </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                    <div className=\"form-group col-xs-6\">\r\n                        <label>Бэлэн авсан</label>\r\n\r\n                        <input type=\"text\" className=\"form-control\" value={this.state.cashReceived} tabindex=\"-2\"\r\n                            ref={function(input){this.cashReceivedInput = input;}.bind(this)}\r\n                            onChange={this.handleTextChange}\r\n                            onKeyDown={this.handleKeyDown}\r\n                            autoFocus\r\n                            onFocus={this.handleFocus} />\r\n                    </div>\r\n\r\n                    <div className=\"form-group col-xs-6\">\r\n                        <label>Хариулт</label>\r\n\r\n                        <p className=\"form-control-static\" >{this.state.cashReturn}₮</p>\r\n                    </div>\r\n\r\n                </div>\r\n                <div className=\"row\">\r\n                    <div className=\"form-group text-center\">\r\n                        <button type=\"button\" className=\"btn btn-primary\" onClick={this.printReceipt}>Баримт хэвлэх</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n});\r\n\r\nvar CounterItem = React.createClass({\r\n    clickHandler: function(){\r\n        this.props.clickCallback(this.props.item);\r\n    },\r\n    render: function(){\r\n        var subPrice = numeral(this.props.item.price * this.props.item.selectedQuantity).format('0,0');\r\n        var className = \"counter-item\";\r\n        if (this.props.isSelected) {\r\n            className=\"counter-item active\";\r\n        }\r\n        return (\r\n            <div className={className} onClick={this.clickHandler}>\r\n                <div className=\"counter-item-name\"><span>{this.props.item.productName}</span></div>\r\n                <div className=\"counter-item-qty\">{this.props.item.selectedQuantity}ш</div>\r\n                <div className=\"counter-item-price\">{subPrice}₮</div>\r\n            </div>\r\n        );\r\n    }\r\n});\r\n\r\nvar CounterItemList = React.createClass({\r\n    getInitialState: function(){\r\n        return {\r\n            selectedIndex: -1,\r\n            quantityEditReset: true\r\n        };\r\n    },\r\n    componentWillReceiveProps: function(nextProps) {\r\n        var selectedIndex = this.state.selectedIndex;\r\n\r\n        if (nextProps.itemList.length == 0) {\r\n            selectedIndex = -1;\r\n\r\n            this.setState({selectedIndex: selectedIndex});\r\n        } else {\r\n            if (selectedIndex >= nextProps.itemList.length) {\r\n                selectedIndex = nextProps.itemList.length - 1;\r\n\r\n                this.setState({selectedIndex: selectedIndex});\r\n            }\r\n        }\r\n    },\r\n    componentDidMount: function() {\r\n        console.log('key handler set up');\r\n        window.addEventListener('keydown', this.handleCounterKey);\r\n    },\r\n    componentWillUnmount: function() {\r\n        window.removeEventListener('keydown', this.handleCounterKey);\r\n    },\r\n    handleCounterKey: function(event) {\r\n        if (event.keyCode == 112) {//F1\r\n            event.preventDefault();\r\n\r\n            console.log('F1');\r\n\r\n            this.setState({selectedIndex: 0, quantityEditReset: true});\r\n            this.rootDiv.focus();\r\n\r\n            return;\r\n        }\r\n\r\n        if (event.keyCode == 121) {//F10\r\n            event.preventDefault();\r\n\r\n            console.log('F10');\r\n\r\n            this.setState({selectedIndex: -1, quantityEditReset: true});\r\n\r\n            this.handlePayBtn();\r\n\r\n            return;\r\n        }\r\n    },\r\n    handleKeyDown: function(event) {\r\n        if (event.keyCode == 27) {//esc\r\n            event.preventDefault();\r\n\r\n            this.setState({selectedIndex: -1, quantityEditReset: true});\r\n\r\n            return;\r\n        }\r\n\r\n        if (event.keyCode == 40) {// down key\r\n            event.preventDefault();\r\n\r\n            if (this.props.itemList.length > 0) {\r\n                var targetIndex = this.state.selectedIndex + 1;\r\n\r\n                if (targetIndex >= this.props.itemList.length) {\r\n                    targetIndex = 0;\r\n                }\r\n\r\n                this.setState({selectedIndex: targetIndex, quantityEditReset: true});\r\n            }\r\n\r\n            return;\r\n        }\r\n        if (event.keyCode == 38) {//up key\r\n            event.preventDefault();\r\n\r\n            if (this.props.itemList.length > 0) {\r\n                var targetIndex = this.state.selectedIndex - 1;\r\n\r\n                if (targetIndex < 0) {\r\n                    targetIndex = this.props.itemList.length - 1;\r\n                }\r\n\r\n                this.setState({selectedIndex: targetIndex, quantityEditReset: true});\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        if (event.keyCode == 107 || event.keyCode == 109 || event.keyCode == 110 || event.keyCode == 46 ||\r\n            event.keyCode == 8 || (event.keyCode >= 96 && event.keyCode <= 105) ) {\r\n            var removeItem = false;\r\n            var backspace = false;\r\n            var minusPlus = 0;\r\n            var number = -1;\r\n            var reset = true;\r\n\r\n            if (event.keyCode == 107) {//plus key\r\n                event.preventDefault();\r\n                minusPlus = 1;\r\n            }\r\n\r\n            if (event.keyCode == 109) {//minus key\r\n                event.preventDefault();\r\n                minusPlus = -1;\r\n            }\r\n\r\n            if (event.keyCode == 110 || event.keyCode == 46) {//del, delete key\r\n                event.preventDefault();\r\n                removeItem = true;\r\n\r\n                this.setState({\r\n                    quantityEditReset: false\r\n                });\r\n            }\r\n\r\n            if (event.keyCode >= 96 && event.keyCode <= 105) {//numpad 0~9 key\r\n                number = event.keyCode - 96;\r\n\r\n                if (this.state.quantityEditReset) {\r\n                    reset = true;\r\n                } else {\r\n                    reset = false;\r\n                }\r\n\r\n                this.setState({\r\n                    quantityEditReset: false\r\n                });\r\n            }\r\n\r\n            if (event.keyCode == 8) {//backspace key\r\n                backspace = true;\r\n            }\r\n\r\n            if (number != -1 || minusPlus != 0 || removeItem || backspace) {\r\n                if (this.state.selectedIndex > -1) {\r\n                    this.props.counterKeyActionCallback(this.state.selectedIndex, reset, number, minusPlus, removeItem, backspace);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    clickCallback: function(targetItem){\r\n        var index = this.props.itemList.findIndex(function(item){\r\n            return  (item.key == targetItem.key);\r\n        });\r\n\r\n        this.setState({selectedIndex: index, quantityEditReset: true});\r\n    },\r\n    handleKeyPad: function(val) {\r\n        console.log(val);\r\n\r\n        var removeItem = false;\r\n        var backspace = false;\r\n        var minusPlus = 0;\r\n        var number = -1;\r\n        var reset = true;\r\n\r\n        if (val == 1 || val == 2 || val == 3 || val == 4 || val == 5 || val == 6 || val == 7 || val == 8 || val == 9 || val == 0) {\r\n            //numbers\r\n            number = val;\r\n\r\n            if (this.state.quantityEditReset) {\r\n                reset = true;\r\n            } else {\r\n                reset = false;\r\n            }\r\n\r\n            this.setState({\r\n                quantityEditReset: false\r\n            });\r\n        }\r\n\r\n        if (val == 'backspace') {\r\n            //backspace\r\n            backspace = true;\r\n        }\r\n\r\n        if (number != -1 || minusPlus != 0 || removeItem || backspace) {\r\n            if (this.state.selectedIndex > -1) {\r\n                this.props.counterKeyActionCallback(this.state.selectedIndex, reset, number, minusPlus, removeItem, backspace);\r\n            }\r\n        }\r\n    },\r\n    handlePayBtn: function(){\r\n        console.debug('handlePayBtn');\r\n\r\n        var variantList = [];\r\n\r\n        this.props.itemList.forEach(function(item, i){\r\n            if (item.selectedQuantity > 0) {\r\n                var orderData = {\r\n                    productNo: item.productNo,\r\n                    variantNo: item.variantNo,\r\n                    selectedQuantity: item.selectedQuantity\r\n                };\r\n\r\n                variantList.push(orderData);\r\n            }\r\n        });\r\n\r\n        if (variantList.length == 0) {\r\n            return;\r\n        }\r\n\r\n        var info = this.calculate();\r\n\r\n        $('#paymentModal').modal('show');\r\n\r\n        var container = $('#paymentModal .modal-body')[0];\r\n\r\n        ReactDOM.unmountComponentAtNode(container);\r\n\r\n        var PaymentModalFactory = React.createFactory(PaymentModal);\r\n        var _this = this;\r\n\r\n        ReactDOM.render(\r\n            PaymentModalFactory({total: info.total, variantList: variantList, callBack: function(orderNo){\r\n                console.log('orderNo:' + orderNo);\r\n\r\n                _this.props.printCallback();\r\n            }}),\r\n            container\r\n        );\r\n    },\r\n    handleCancelBtn: function(){\r\n        console.debug('handleCancelBtn');\r\n\r\n        this.props.printCallback();\r\n    },\r\n    calculate: function(){\r\n        var price = 0;\r\n        var vat = 0;\r\n        var total = 0;\r\n        var itemCount = 0;\r\n\r\n        this.props.itemList.forEach(function(item, i){\r\n            itemCount += item.selectedQuantity;\r\n            total += item.price * item.selectedQuantity;\r\n        });\r\n\r\n        if (total > 0) {\r\n            price = total;\r\n            vat = total * 0.1;\r\n        }\r\n\r\n        return {\r\n            itemCount: itemCount,\r\n            price: price,\r\n            vat: vat,\r\n            total: total\r\n        }\r\n    },\r\n    render: function(){\r\n        var counterItemList = [];\r\n        var selectedIndex = this.state.selectedIndex;\r\n\r\n        this.props.itemList.forEach(function(item, i){\r\n            var isSelected = false;\r\n            if (selectedIndex == i) {\r\n                isSelected = true;\r\n            }\r\n            counterItemList.push(<CounterItem item={item} key={item.key} isSelected={isSelected} clickCallback={this.clickCallback}  />);\r\n        }.bind(this));\r\n\r\n        var info = this.calculate();\r\n\r\n        var price = numeral(info.price).format('0,0');\r\n        var vat = numeral(info.vat).format('0,0');\r\n        var total = numeral(info.total).format('0,0');\r\n\r\n        return (\r\n            <div className=\"counter-content\">\r\n                <div className=\"counter-item-list\" tabIndex=\"3\" onKeyDown={this.handleKeyDown} ref={function(div){this.rootDiv = div;}.bind(this)}>\r\n                    {counterItemList}\r\n                </div>\r\n\r\n                <div className=\"counter-info\">\r\n                    <div className=\"counter-pay-info\">\r\n                        <div className=\"price\"><span>Нийт</span> <span>{price}₮</span></div>\r\n                        <div className=\"vat\"><span>НӨАТ</span> <span>{vat}₮</span></div>\r\n                        <div className=\"total\"><span>Төлөх дүн</span> <span>{total}₮</span></div>\r\n                    </div>\r\n\r\n                    <div className=\"counter-pad\">\r\n                        <div className=\"actionpad\">\r\n                            <button className=\"button pay top-border left-border top-left-corner\" onClick={this.handlePayBtn}>Төлөх</button>\r\n                            <button className=\"button cancel left-border bottom-left-corner\" onClick={this.handleCancelBtn}>Цуцлах</button>\r\n                        </div>\r\n                        <div className=\"numpad\">\r\n                            <button className=\"input-button number-char top-border\" onClick={this.handleKeyPad.bind(this, 1)}>1</button>\r\n                            <button className=\"input-button number-char top-border\" onClick={this.handleKeyPad.bind(this, 2)}>2</button>\r\n                            <button className=\"input-button number-char top-border top-right-corner\" onClick={this.handleKeyPad.bind(this, 3)}>3</button>\r\n                            <button className=\"input-button number-char\" onClick={this.handleKeyPad.bind(this, 4)}>4</button>\r\n                            <button className=\"input-button number-char\" onClick={this.handleKeyPad.bind(this, 5)}>5</button>\r\n                            <button className=\"input-button number-char\" onClick={this.handleKeyPad.bind(this, 6)}>6</button>\r\n                            <button className=\"input-button number-char\" onClick={this.handleKeyPad.bind(this, 7)}>7</button>\r\n                            <button className=\"input-button number-char\" onClick={this.handleKeyPad.bind(this, 8)}>8</button>\r\n                            <button className=\"input-button number-char\" onClick={this.handleKeyPad.bind(this, 9)}>9</button>\r\n                            <button className=\"input-button number-char\">&nbsp;</button>\r\n                            <button className=\"input-button number-char\" onClick={this.handleKeyPad.bind(this, 0)}>0</button>\r\n                            <button className=\"input-button number-char bottom-right-corner\" onClick={this.handleKeyPad.bind(this, 'backspace')}><i className=\"fa fa-remove\"></i></button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n});\r\n\r\nvar PosCounter = React.createClass({\r\n    getInitialState: function(){\r\n        return {\r\n            time: moment()\r\n        }\r\n    },\r\n    componentDidMount: function() {\r\n        console.log('key handler set up');\r\n        window.addEventListener('keydown', this.handleKeyDown);\r\n\r\n        //set timer\r\n        this.timer = setInterval(function(){\r\n            var time = this.state.time.clone().add(1, 'minutes');\r\n\r\n            this.setState({\r\n                time: time\r\n            })\r\n        }.bind(this), 1000 * 60);\r\n    },\r\n    componentWillUnmount: function() {\r\n        window.removeEventListener('keydown', this.handleKeyDown);\r\n\r\n        console.log('will unmount');\r\n\r\n        clearInterval(this.timer);\r\n        this.timer = null;\r\n    },\r\n    render: function(){\r\n        var displayTime = this.state.time.format('YYYY/MM/DD HH:mm');\r\n\r\n        return (\r\n            <div className=\"mm-pos-counter\">\r\n                <div className=\"counter-header\">\r\n\r\n                    <div className=\"row\">\r\n                        <div className=\"col-xs-6\">\r\n                            <div className=\"mm-pos-logo\"><img src=\"img/logo.png\" /></div>\r\n\r\n                        </div>\r\n                        <div className=\"col-xs-6\">\r\n                            <div>\r\n                                <div className=\"mm-pos-branch\">{this.props.branchName}</div>\r\n                                <div className=\"mm-pos-date\">{displayTime}</div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n\r\n                </div>\r\n                <CounterItemList itemList={this.props.itemList} counterKeyActionCallback={this.props.counterKeyActionCallback} printCallback={this.props.printCallback}/>\r\n\r\n\r\n            </div>\r\n        );\r\n    }\r\n});\r\n\r\n"]}