{"version":3,"sources":["../jsx/product-widget.js"],"names":["ProductWidget","React","createClass","propTypes","productNo","PropTypes","number","variantNo","parentNo","quantity","type","string","callBack","func","getInitialState","product","name","price","imageList","optionList","variantList","selectedOptionList","selectedVariantList","reason","componentDidMount","serverRequest","$","get","props","response","error_code","console","log","forEach","option","push","no","value","variant","selectedQuantity","length","option1","stockTrack","selectedVariant","bind","setState","componentWillUnmount","abort","renderOptionList","state","_this","map","index","handleOptionChange","valueList","renderVariantList","optionLength","variantName","option2","option3","buttonStyle","display","maxQuantity","handleQuantityChange","handleRemoveVariant","selectedIndex","variantUpdates","$splice","addons","update","optionNo","event","target","item","allSet","addVariant","handleAdd","alert","concat","handleReasonChange","render","productImageUrl","image","url","buttonName","priceStr","comparePrice","reasonStyle"],"mappings":"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","file":"product-widget.js","sourcesContent":["\r\nvar ProductWidget = React.createClass({\r\n    propTypes:\r\n    {\r\n        productNo:React.PropTypes.number,\r\n        variantNo: React.PropTypes.number,\r\n        parentNo: React.PropTypes.number,\r\n        quantity: React.PropTypes.number,\r\n        type: React.PropTypes.string,\r\n        callBack: React.PropTypes.func\r\n    },\r\n    getInitialState: function(){\r\n        return {\r\n            product: {\r\n                name: '',\r\n                price: 0,\r\n                imageList:[],\r\n                optionList:[],\r\n                variantList:[]\r\n            },\r\n            selectedOptionList:[],\r\n            selectedVariantList:[],\r\n            reason: ''\r\n        }\r\n    },\r\n    componentDidMount: function() {\r\n        this.serverRequest = $.get('/api/products/' + this.props.productNo, function (response) {\r\n            if (response.error_code == '1000') {\r\n                console.log('response: %O', response);\r\n\r\n                var selectedOptionList = [];\r\n                 response.product.optionList.forEach(function(option){\r\n                    selectedOptionList.push({no: option.no, value: ''});\r\n                 });\r\n\r\n                response.product.variantList.forEach(function(variant){\r\n                    variant.selectedQuantity = 1;\r\n                });\r\n\r\n                var selectedVariantList = [];\r\n                if (this.props.type == 'NORMAL' || this.props.type == 'ADD') {\r\n                    if (response.product.optionList.length == 0) {\r\n                        selectedVariantList = [{no: 0, option1: 'Үндсэн сонголт', stockTrack: response.product.stockTrack, quantity: response.product.quantity, price:response.product.price, selectedQuantity: 1}];\r\n                    }\r\n                } else if (this.props.type == 'REFUND' || this.props.type == 'CHANGE') {\r\n                    if (response.product.optionList.length == 0) {\r\n                        selectedVariantList = [{no: 0, option1: 'Үндсэн сонголт', stockTrack: response.product.stockTrack, quantity: this.props.quantity, parentNo: this.props.parentNo, selectedQuantity: this.props.quantity}];\r\n                    } else {\r\n                        var selectedVariant = null;\r\n                        response.product.variantList.forEach(function(variant){\r\n                            if (variant.no == this.props.variantNo) {\r\n                                selectedVariant = variant;\r\n                            }\r\n                        }.bind(this));\r\n\r\n                        if (selectedVariant) {\r\n                            selectedVariant.parentNo = this.props.parentNo;\r\n                            selectedVariant.quantity = this.props.quantity;\r\n                            selectedVariant.selectedQuantity = this.props.quantity;\r\n                        }\r\n\r\n                        selectedVariantList = [selectedVariant];\r\n                    }\r\n                }\r\n\r\n\r\n                 console.log('selectedOptionList %O', selectedOptionList);\r\n\r\n                this.setState({\r\n                    product: response.product,\r\n                    selectedOptionList: selectedOptionList,\r\n                    selectedVariantList: selectedVariantList\r\n                });\r\n            } else {\r\n\r\n            }\r\n\r\n        }.bind(this));\r\n    },\r\n    componentWillUnmount: function() {\r\n        this.serverRequest.abort();\r\n    },\r\n\r\n    renderOptionList: function() {\r\n        console.log(this.state.product.optionList);\r\n        var _this = this;\r\n        if (this.props.type == 'NORMAL' || this.props.type == 'ADD') {\r\n            return (\r\n                <div className=\"form\">\r\n\r\n                {\r\n                  this.state.product.optionList.map(function (option, index) {\r\n                      return (\r\n                          <div key={option.no} className=\"form-group\">\r\n                              <label>{option.name}</label>\r\n                              <div className=\"mm-select-wrapper\">\r\n                              <select className=\"form-control\" ref=\"option\" value={this.state.selectedOptionList[index].value} onChange={this.handleOptionChange.bind(_this, option.no)} >\r\n                                  <option value=\"\" >Сонголт</option>\r\n                                    {\r\n                                        option.valueList.map(function (value) {\r\n                                            return (<option key={value} value={value}>{value}</option>);\r\n                                        })\r\n                                        }\r\n                              </select>\r\n                              </div>\r\n                          </div>\r\n                      )\r\n                  }.bind(this))\r\n                  }\r\n\r\n                </div>\r\n\r\n\r\n            );\r\n        } else {\r\n            return (<div className=\"form\"></div>);\r\n        }\r\n\r\n    },\r\n\r\n    renderVariantList: function() {\r\n        var _this = this;\r\n        var optionLength = this.state.selectedOptionList.length;\r\n        var variantList = this.state.selectedVariantList.map(function (variant, index) {\r\n            var variantName = variant.option1;\r\n            if (optionLength > 1) {\r\n                variantName = variantName + '/' + variant.option2;\r\n            }\r\n            if (optionLength > 2) {\r\n                variantName = variantName + '/' + variant.option3;\r\n            }\r\n\r\n            var buttonStyle = {display: 'block'};\r\n            if (variant.no == 0) {\r\n                buttonStyle.display = 'none';\r\n            }\r\n\r\n            if (this.props.type == 'REFUND' || this.props.type == 'CHANGE') {\r\n                buttonStyle.display = 'none';\r\n            }\r\n\r\n            var maxQuantity = variant.quantity;\r\n            if (this.props.type == 'NORMAL' || this.props.type == 'ADD') {\r\n                if (!variant.stockTrack) {\r\n                    maxQuantity = 100;\r\n                }\r\n            }\r\n            if (this.props.type == 'REFUND' || this.props.type == 'CHANGE') {\r\n                maxQuantity = variant.quantity;\r\n            }\r\n\r\n            return (\r\n                <div className=\"form-group\" key={variant.no}>\r\n                    <label className=\"col-sm-6 control-label product-variant-name\">{variantName}</label>\r\n                    <div className=\"col-sm-3\">\r\n                        <NumberPicker value={variant.selectedQuantity} onChange={this.handleQuantityChange.bind(_this, variant.no)} min=\"1\" max={maxQuantity} />\r\n                    </div>\r\n                    <div className=\"col-sm-3\" style={buttonStyle}>\r\n                        <button type=\"button\" className=\"btn btn-sm btn-default\" onClick={this.handleRemoveVariant.bind(_this, variant.no)}><i className=\"fa fa-trash\"></i></button>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }.bind(this));\r\n\r\n        return (\r\n            <div className=\"form-horizontal\">\r\n            {variantList}\r\n            </div>\r\n        );\r\n    },\r\n\r\n    handleRemoveVariant: function(variantNo) {\r\n        var selectedIndex = -1;\r\n        this.state.selectedVariantList.forEach(function(variant, index){\r\n            if (variant.no == variantNo) {\r\n                selectedIndex = index;\r\n            }\r\n        });\r\n\r\n        var variantUpdates = {$splice: [[selectedIndex, 1]]};\r\n\r\n        this.setState({\r\n            selectedVariantList : React.addons.update(this.state.selectedVariantList, variantUpdates)\r\n        })\r\n    },\r\n\r\n    handleOptionChange: function(optionNo, event){\r\n        /*console.log(arguments);*/\r\n        var value = event.target.value;\r\n        console.log('value: ', value);\r\n\r\n        var selectedOptionList = this.state.selectedOptionList;\r\n\r\n        selectedOptionList.forEach(function(item){\r\n            if (item.no == optionNo) {\r\n                item.value = value;\r\n            }\r\n        });\r\n\r\n        var allSet = true;\r\n        selectedOptionList.forEach(function(item){\r\n            if (item.value == '') {\r\n                allSet = false;\r\n            }\r\n        });\r\n\r\n        this.setState({\r\n            selectedOptionList: selectedOptionList\r\n        });\r\n\r\n        if (allSet) {\r\n            var selectedVariant = null;\r\n\r\n            this.state.product.variantList.forEach(function(variant, index){\r\n                if (selectedOptionList.length == 1 && variant.option1 == selectedOptionList[0].value) {\r\n                    selectedVariant = variant;\r\n                }\r\n                if (selectedOptionList.length == 2 && variant.option1 == selectedOptionList[0].value &&\r\n                    variant.option2 == selectedOptionList[1].value) {\r\n                    selectedVariant = variant;\r\n                }\r\n                if (selectedOptionList.length == 3 && variant.option1 == selectedOptionList[0].value &&\r\n                    variant.option2 == selectedOptionList[1].value && variant.option3 == selectedOptionList[2].value) {\r\n                    selectedVariant = variant;\r\n                }\r\n            });\r\n\r\n            if (selectedVariant) {\r\n\r\n                selectedOptionList.forEach(function(item){\r\n                    item.value = '';\r\n                });\r\n\r\n                this.setState({\r\n                    selectedOptionList: selectedOptionList\r\n                });\r\n\r\n                this.addVariant(selectedVariant);\r\n            }\r\n        }\r\n\r\n        //add variant\r\n        /*var variant = this.state.product.variantList[1];\r\n         this.addVariant(variant);*/\r\n    },\r\n\r\n    handleQuantityChange: function(variantNo, quantity){\r\n        var value = quantity;\r\n\r\n        console.log('variantNo: %O, value: %O', variantNo, value);\r\n\r\n        var selectedVariantList = this.state.selectedVariantList;\r\n        selectedVariantList.forEach(function(variant){\r\n           if (variant.no == variantNo) {\r\n               variant.selectedQuantity = value;\r\n           }\r\n        });\r\n\r\n        console.log('selectedVariantList:%O', selectedVariantList);\r\n\r\n        this.setState({\r\n            selectedVariantList: selectedVariantList\r\n        });\r\n    },\r\n\r\n    handleAdd: function() {\r\n        //submit form\r\n        //event.preventDefault();\r\n\r\n        console.log('handleAdd:' + this.props.type);\r\n\r\n        if (this.props.type == 'REFUND' || this.props.type  == 'CHANGE') {\r\n            if (!this.state.reason) {\r\n                alert('Буцаах/солих шалтгаан заавал сонгоно уу');\r\n                return;\r\n            }\r\n\r\n            this.props.callBack(this.props.productNo, this.state.product.name, this.state.selectedVariantList, this.props.type, this.state.reason);\r\n        } else {\r\n            this.props.callBack(this.props.productNo, this.state.product.name, this.state.selectedVariantList, this.props.type);\r\n        }\r\n    },\r\n\r\n    addVariant: function(variant){\r\n        this.setState({\r\n            selectedVariantList: this.state.selectedVariantList.concat([variant])\r\n        });\r\n    },\r\n\r\n    handleReasonChange: function(event) {\r\n        var value = event.target.value;\r\n\r\n        this.setState({reason: value});\r\n    },\r\n\r\n    render: function(){\r\n        var productImageUrl = '';\r\n\r\n        this.state.product.imageList.forEach(function(image){\r\n            if (image.type == 'intro') {\r\n                productImageUrl = image.url;\r\n            }\r\n        });\r\n\r\n        var buttonName = 'Нэмэх';\r\n        if (this.props.type == 'REFUND') {\r\n            buttonName = 'Буцаах';\r\n        }\r\n        if (this.props.type == 'CHANGE') {\r\n            buttonName = 'Солих';\r\n        }\r\n\r\n        var priceStr = this.state.product.price + '₮';\r\n\r\n        if (this.state.product.comparePrice) {\r\n            priceStr = this.state.product.comparePrice + '₮ -> ' + (this.state.product.price) + '₮';\r\n        }\r\n\r\n        var reasonStyle = {display: 'none'};\r\n        if (this.props.type == 'REFUND' || this.props.type == 'CHANGE') {\r\n            reasonStyle = {display: 'block'};\r\n        }\r\n\r\n        return (\r\n            <div className=\"mm-product-widget\">\r\n                <div className=\"form-group\" style={reasonStyle}>\r\n                    <label>Буцаах/солих шалтгаах</label>\r\n                    <div className=\"mm-select-wrapper\">\r\n                        <select className=\"form-control\" ref=\"reason\" value={this.state.reason} onChange={this.handleReasonChange} >\r\n                            <option value=\"\" >Сонголт</option>\r\n                            <option value=\"PRODUCT_DEFECT\" >Бараа асуудалтай</option>\r\n                            <option value=\"SENT_OTHER_PRODUCT\" >Буруу бараа илгээсэн</option>\r\n                            <option value=\"SIZE_PROBLEM\" >Хэмжээ таараагүй</option>\r\n                            <option value=\"NOT_LIKE\" >Бараа таалагдаагүй</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                    <div className=\"col-sm-12\">\r\n                        <h5>{this.state.product.name}</h5>\r\n                    </div>\r\n                </div>\r\n\r\n\r\n                <div className=\"row\">\r\n                    <div className=\"col-sm-3\">\r\n                        <img src={productImageUrl} width=\"100%\"/>\r\n                    </div>\r\n                    <div className=\"col-sm-9\">\r\n                        <p>{priceStr}</p>\r\n                        {this.renderOptionList()}\r\n\r\n                        {this.renderVariantList()}\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"row\">\r\n                    <div className=\"col-sm-12 text-center\">\r\n                        <button type=\"button\" className=\"btn btn-primary\" onClick={this.handleAdd}>{buttonName}</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        );\r\n    }\r\n\r\n});\r\n"]}