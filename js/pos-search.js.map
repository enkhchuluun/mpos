{"version":3,"sources":["../jsx/pos-search.js"],"names":["SearchInput","React","createClass","getInitialState","filterText","componentDidMount","console","log","window","addEventListener","handleSearchFocus","componentWillUnmount","removeEventListener","componentWillReceiveProps","nextProps","reset","setState","event","keyCode","preventDefault","refs","searchInputTextBox","focus","handleTextChange","value","handleFocus","handleKeyDown","stopPropagation","search","blur","props","searchCallBack","render","state","ProductItem","componentDidUpdate","isSelected","handleClick","itemClickCallback","variant","name","productName","sku","price","numeral","format","className","div","myDiv","bind","imgUrl","ProductSearchArea","selectedIndex","products","variantList","resetCallback","rootDiv","length","$","ReactDOM","findDOMNode","parent","innerWidth","outerWidth","rowSize","Math","floor","targetIndex","itemAddCallback","converter","data","result","map","item","id","no","text","itemClickHandler","findIndex","key","unescapeHtml","safe","replace","extractVariantList","_this","forEach","product","i","imageList","img","type","url","ii","variantName","option1","option2","option3","variantNo","productNo","selectedQuantity","push","cd","ajax","dataType","cache","success","error_code","alert","message","error","xhr","status","err","toString","productItemList","refName"],"mappings":"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","file":"pos-search.js","sourcesContent":["var SearchInput = React.createClass({\r\n    getInitialState: function() {\r\n        return {\r\n            filterText: ''\r\n        };\r\n    },\r\n    componentDidMount: function() {\r\n        console.log('key handler set up');\r\n        window.addEventListener('keydown', this.handleSearchFocus);\r\n    },\r\n    componentWillUnmount: function() {\r\n        window.removeEventListener('keydown', this.handleSearchFocus);\r\n    },\r\n    componentWillReceiveProps: function(nextProps) {\r\n        console.log('search input prop will receive: %O', nextProps);\r\n        if (nextProps.reset) {\r\n            console.log('reset -> -> true');\r\n            this.setState({\r\n                filterText: ''\r\n            })\r\n        }\r\n    },\r\n    handleSearchFocus: function(event) {\r\n        if (event.keyCode == 113) {//F2\r\n            event.preventDefault();\r\n\r\n            console.log('F2');\r\n\r\n            this.refs.searchInputTextBox.focus();\r\n\r\n            return;\r\n        }\r\n    },\r\n    handleTextChange: function(){\r\n        var filterText = this.refs.searchInputTextBox.value;\r\n\r\n        this.setState({\r\n            filterText: filterText\r\n        });\r\n    },\r\n    handleFocus: function(){\r\n\r\n    },\r\n    handleKeyDown: function(event){\r\n        if (event.keyCode == 13) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n\r\n            console.log('enter on search box');\r\n\r\n            this.search();\r\n        }\r\n\r\n        if (event.keyCode == 37 || event.keyCode == 38 || event.keyCode == 39 || event.keyCode == 40) {\r\n            this.refs.searchInputTextBox.blur();\r\n        }\r\n    },\r\n    search: function(){\r\n        console.log('search');\r\n        //callback\r\n        var filterText = this.refs.searchInputTextBox.value;\r\n        this.props.searchCallBack(filterText);\r\n    },\r\n    render: function(){\r\n        return (\r\n            <div className=\"input-group\">\r\n                <input type=\"text\" className=\"form-control\" placeholder=\"Барааны код, нэр\" tabindex=\"2\"\r\n                    value={this.state.filterText}\r\n                    ref=\"searchInputTextBox\"\r\n                    onChange={this.handleTextChange}\r\n                    onFocus={this.handleFocus}\r\n                    onKeyDown={this.handleKeyDown}\r\n                />\r\n                <span className=\"input-group-btn\" onClick={this.search} >\r\n                    <button type=\"submit\" className=\"btn btn-default\">\r\n                        <i className=\"fa fa-search\"></i>\r\n                    </button>\r\n                </span>\r\n            </div>\r\n        );\r\n    }\r\n});\r\n\r\nvar ProductItem = React.createClass({\r\n    componentDidUpdate: function() {\r\n        if (this.props.isSelected) {\r\n            //this.myDiv.focus();\r\n        }\r\n    },\r\n    handleClick: function(){\r\n        this.props.itemClickCallback(this.props.variant);\r\n    },\r\n    render: function(){\r\n        var name = this.props.variant.productName;\r\n\r\n        if (this.props.variant.sku) {\r\n            name += ' (' + this.props.variant.sku + ')';\r\n        }\r\n\r\n        var price = numeral(this.props.variant.price).format('0,0');\r\n\r\n        var className = \"mm-pos-product\";\r\n        if (this.props.isSelected) {\r\n            className = \"mm-pos-product active\";\r\n        }\r\n\r\n\r\n        return (\r\n            <div className={className} onClick={this.handleClick} ref={function(div){this.myDiv = div;}.bind(this)}>\r\n                <div className=\"image-wrapper\">\r\n                    <div className=\"image-content\">\r\n                        <span></span><img src={'http://' + this.props.variant.imgUrl} />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"product-name\">{name}</div>\r\n                <div className=\"product-price\">{price}₮</div>\r\n            </div>\r\n        );\r\n    }\r\n});\r\n\r\nvar ProductSearchArea = React.createClass({\r\n    getInitialState: function() {\r\n        return {\r\n            selectedIndex: -1,\r\n            products: [],\r\n            variantList:[]\r\n        };\r\n    },\r\n    componentWillReceiveProps: function(nextProps) {\r\n        console.log('search area prop will receive: %O', nextProps);\r\n        if (nextProps.reset) {\r\n            console.log('reset -> true');\r\n            this.setState({\r\n                selectedIndex: -1,\r\n                products: [],\r\n                variantList:[]\r\n            });\r\n\r\n            this.props.resetCallback();\r\n        }\r\n    },\r\n    handleClick: function(){\r\n          console.log('click on search area');\r\n    },\r\n    handleKeyDown: function(event) {\r\n        console.log('key down on search area:' + event.keyCode);\r\n        if (event.keyCode == 40) {//down key\r\n            event.preventDefault();\r\n\r\n            this.rootDiv.focus();\r\n\r\n            if (this.state.variantList.length > 0) {\r\n                //find relative dim of target index div\r\n                if (this.state.selectedIndex >= 0) {\r\n                    var div = $(ReactDOM.findDOMNode(this.refs['product-item-' + this.state.selectedIndex]));\r\n                    //parent with\r\n                    console.log('parent width:%O, div width:%O', div.parent().innerWidth(), div.outerWidth(true));\r\n                    //item with\r\n                    var rowSize = Math.floor((div.parent().innerWidth() - 20) / div.outerWidth(true));\r\n                    /*var rowCount = Math.ceil(this.state.variantList.length / rowSize);\r\n                    var currentRow = Math.ceil(this.state.selectedIndex + 1 / rowSize);*/\r\n\r\n                    console.log('row size:' + rowSize);\r\n\r\n\r\n                    if (this.state.selectedIndex + rowSize < this.state.variantList.length) {\r\n                        var targetIndex = this.state.selectedIndex + rowSize;\r\n                        this.setState({selectedIndex: targetIndex});\r\n                    }\r\n                } else {\r\n                    this.setState({selectedIndex: 0});\r\n                }\r\n            }\r\n        }\r\n\r\n        if (event.keyCode == 38) {//up key\r\n            event.preventDefault();\r\n\r\n            this.rootDiv.focus();\r\n\r\n            if (this.state.variantList.length > 0) {\r\n                if (this.state.selectedIndex >= 0) {\r\n                    var div = $(ReactDOM.findDOMNode(this.refs['product-item-' + this.state.selectedIndex]));\r\n                    //parent with\r\n                    //console.log('parent width:%O, div width:%O', div.parent().width(), div.outerWidth(true));\r\n                    //item with\r\n                    var rowSize = Math.floor((div.parent().innerWidth() - 20) / div.outerWidth(true));\r\n\r\n                    if (this.state.selectedIndex - rowSize >= 0) {\r\n                        var targetIndex = this.state.selectedIndex - rowSize;\r\n                        this.setState({selectedIndex: targetIndex});\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (event.keyCode == 39) {//right key\r\n            event.preventDefault();\r\n\r\n            this.rootDiv.focus();\r\n\r\n            if (this.state.variantList.length > 0) {\r\n                var targetIndex = this.state.selectedIndex + 1;\r\n\r\n                if (targetIndex >= this.state.variantList.length) {\r\n                    targetIndex = 0;\r\n                }\r\n\r\n\r\n                this.setState({selectedIndex: targetIndex});\r\n            }\r\n        }\r\n\r\n        if (event.keyCode == 37) {//left key\r\n            event.preventDefault();\r\n\r\n            this.rootDiv.focus();\r\n\r\n            if (this.state.variantList.length > 0) {\r\n                var targetIndex = this.state.selectedIndex - 1;\r\n\r\n                if (targetIndex < 0) {\r\n                    targetIndex = this.state.variantList.length - 1;\r\n                }\r\n                this.setState({selectedIndex: targetIndex});\r\n            }\r\n        }\r\n\r\n        if (event.keyCode == 13) {//enter key\r\n            console.log('enter on item');\r\n            var targetIndex = this.state.selectedIndex;\r\n            if (targetIndex > -1) {\r\n                var variant = this.state.variantList[targetIndex];\r\n                this.props.itemAddCallback(variant);\r\n            }\r\n\r\n        }\r\n    },\r\n    converter: function(data){\r\n        var result = $.map(data, function(item){\r\n            return {id: item.no, text: item.name}\r\n        });\r\n\r\n        return result;\r\n    },\r\n    itemClickHandler: function(variant){\r\n        console.log('itemClickHandler variant:%O', variant);\r\n\r\n        var targetIndex = this.state.variantList.findIndex(function(item){\r\n            return (item.key == variant.key);\r\n        });\r\n\r\n        if (targetIndex > -1) {\r\n            this.setState({\r\n                selectedIndex: targetIndex\r\n            });\r\n        }\r\n\r\n        this.props.itemAddCallback(variant);\r\n    },\r\n    unescapeHtml: function(safe){\r\n        return safe.replace(/&amp;/g, '&')\r\n            .replace(/&lt;/g, '<')\r\n            .replace(/&gt;/g, '>')\r\n            .replace(/&quot;/g, '\"')\r\n            .replace(/&#039;/g, \"'\")\r\n            .replace(/&#x27;/g, \"'\");\r\n    },\r\n    extractVariantList: function(products) {\r\n        var variantList = [];\r\n        var _this = this;\r\n        if (products) {\r\n            products.forEach(function(product, i){\r\n                if (product.variantList && product.variantList.length > 0) {\r\n                    //product with variant\r\n\r\n                    var imgUrl = '';\r\n                    product.imageList.forEach(function(img){\r\n                        if (img.type == 'intro') {\r\n                            imgUrl = img.url;\r\n                        }\r\n                    });\r\n\r\n                    product.variantList.forEach(function(variant, ii){\r\n                        var name = product.name;\r\n\r\n                        var variantName = _this.unescapeHtml(variant.option1);\r\n                        if (variant.option2) {\r\n                            variantName = variantName + ' ' + _this.unescapeHtml(variant.option2);\r\n                        }\r\n                        if (variant.option3) {\r\n                            variantName = variantName + ' ' + _this.unescapeHtml(variant.option3);\r\n                        }\r\n                        name += '/' + variantName + '/';\r\n\r\n                        var data = {\r\n                            key: product.no + '-' + variant.no,\r\n                            variantNo: variant.no,\r\n                            productNo: product.no,\r\n                            productName: name,\r\n                            option1: variant.option1,\r\n                            option2: variant.option2,\r\n                            option3: variant.option3,\r\n                            selectedQuantity: 1,\r\n                            sku: variant.sku,\r\n                            price: variant.price,\r\n                            imgUrl: imgUrl\r\n                        };\r\n\r\n                        variantList.push(data);\r\n                    });\r\n                } else {\r\n                    //product without variant\r\n\r\n                    var name = product.name;\r\n\r\n                    var imgUrl = '';\r\n                    product.imageList.forEach(function(img){\r\n                        if (img.type == 'intro') {\r\n                            imgUrl = img.url;\r\n                        }\r\n                    });\r\n\r\n                    var data = {\r\n                        key: product.no + '-0',\r\n                        variantNo: 0,\r\n                        productNo: product.no,\r\n                        productName: name,\r\n                        option1: null,\r\n                        option2: null,\r\n                        option3: null,\r\n                        selectedQuantity: 1,\r\n                        sku: product.cd,\r\n                        price: product.price,\r\n                        imgUrl: imgUrl\r\n                    };\r\n\r\n                    variantList.push(data);\r\n                }\r\n            });\r\n        }\r\n\r\n        return variantList;\r\n    },\r\n    searchCallBack: function(filterText) {\r\n        if (filterText) {\r\n            $.ajax({\r\n                url: 'http://merchant.jurur.mn/api/products?sellerNo=1&limit=30&title=' + filterText,\r\n                dataType: 'json',\r\n                cache: false,\r\n                success: function(data) {\r\n                    if (data.error_code == 1000) {\r\n                        var variantList = this.extractVariantList(data.products);\r\n                        this.setState({products: data.products, variantList: variantList, selectedIndex: -1});\r\n                    } else {\r\n                        alert(data.message);\r\n                        console.error('error:%O', data);\r\n                    }\r\n\r\n                }.bind(this),\r\n                error: function(xhr, status, err) {\r\n                    alert('серветэй холбогдоход алдаа гарлаа');\r\n                    console.error(url, status, err.toString());\r\n\r\n                }.bind(this)\r\n            });\r\n        } else {\r\n            this.setState({products: [], variantList:[], selectedIndex: -1});\r\n        }\r\n    },\r\n    render: function(){\r\n        var productItemList = [];\r\n\r\n        this.state.variantList.forEach(function(variant, i){\r\n            var isSelected = false;\r\n            if (this.state.selectedIndex == i) {\r\n                isSelected = true;\r\n            }\r\n\r\n            var refName = \"product-item-\" + i;\r\n            /*console.log(refName);*/\r\n            productItemList.push(<ProductItem variant={variant} key={variant.key} ref={refName} itemClickCallback={this.itemClickHandler} isSelected={isSelected} />);\r\n        }.bind(this));\r\n\r\n        return (\r\n            <div onKeyDown={this.handleKeyDown} onClick={this.handleClick} >\r\n\r\n                <div className=\"mm-pos-search-input\">\r\n                    <SearchInput searchCallBack={this.searchCallBack} reset = {this.props.reset}  />\r\n                </div>\r\n\r\n                <div className=\"mm-pos-search-result\" tabIndex=\"1\" ref={function(div){this.rootDiv = div;}.bind(this)}>\r\n                        {productItemList}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n});\r\n"]}